<p id="notice"><%= notice %></p>

<h1>Listing Readings</h1>

<div id="chartContainer" style="height: 300px; width: 100%"></div>

<script type="text/javascript">


  window.onload = function () {
    $.getJSON('/readings.json', function(data) {

      console.log(data);

      dataPoints = [];
      dataPoints[0] = [];
      dataPoints[1] = [];
      for (var i = 0; i < data.length; i++) {
        var date = new Date(data[i].created_at);
        var temperature = parseFloat(data[i].temperature);
        var humidity = parseFloat(data[i].humidity);
        dataPoints[0].push({
          x: date, y: temperature
        });
        dataPoints[1].push({
          x: date, y: humidity
        });
      }

      loadChart(dataPoints);

    })
  }



</script>

<table>
  <thead>
    <tr>
      <th>Temperature</th>
      <th>Humidity</th>
      <th>Created</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @readings.each do |reading| %>
      <tr>
        <td><%= reading.temperature %></td>
        <td><%= reading.humidity %></td>
        <td><%= reading.created_at.to_formatted_s(:short) %></td>
        <td><%= link_to 'Show', reading %></td>
        <td><%= link_to 'Edit', edit_reading_path(reading) %></td>
        <td><%= link_to 'Destroy', reading, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<%= link_to 'New Reading', new_reading_path %>
